barplot(table_for_graph, xlab = 'Stress means a situation in which a person feels tense, restless, nervous, or anxious, or is unable to sleep at night because his/her mind is troubled all the time.\n Within the last 30 days, how often have you felt this kind of stress?', ylab = 'Frequency', main = 'Distribution of people and the prevalence of stress in  their lives', col = graphcolors, border = 'black')
barplot(table_for_graph, xlab = 'Stress means a situation in which a person feels tense, restless, nervous, or anxious, or is unable to sleep at night\n because his/her mind is troubled all the time. Within the last 30 days, how often have you felt this kind of stress?', ylab = 'Frequency', main = 'Distribution of people and the prevalence of stress in  their lives', col = graphcolors, border = 'black')
barplot(table_for_graph, xlab = 'Stress means a situation in which a person feels tense, restless, nervous, or anxious, or is unable to sleep at night\n because his/her mind is troubled all the time. Within the last 30 days, how often have you felt this kind of stress?', ylab = 'Frequency', main = 'Distribution of people and the prevalence of stress in their lives', col = graphcolors, border = 'black')
unique(njresponses$EMTSUPRT)
table_for_graph <- table(njresponses[njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$LSATISFY != 'Refused',]$LSATISFY)
table_for_graph
table_for_graph <- table(njresponses[njresponses$SDHSTRE1 != 'Donâ€™t know/Not Sure' & njresponses$SDHSTRE1 != 'Refused',]$SDHSTRE1)
table_for_graph
table_for_graph <- table(njresponses[njresponses$SDHSTRE1 != 'Donâ€™t know/Not Sure' & njresponses$SDHSTRE1 != 'Refused',]$SDHSTRE1)
table_for_graph <- table_for_graph[c('Always','Usually','Sometimes','Rarely','Never')]
table_for_graph
table(njresponses$EMTSUPRT)
table(njresponses$SDHISOLT)
table_for_graph <- table(njresponses[njresponses$EMTSUPRT != 'Donâ€™t know/Not Sure' & njresponses$EMTSUPRT != 'Refused',]$EMTSUPRT)
table_for_graph
table_for_graph <- table(njresponses[njresponses$EMTSUPRT != 'Donâ€™t know/Not sure' & njresponses$EMTSUPRT != 'Refused',]$EMTSUPRT)
table_for_graph <- table_for_graph[c('Always','Usually','Sometimes','Rarely','Never')]
table_for_graph
barplot(table_for_graph, xlab = 'How often do you get the social and emotional support you need?', ylab = 'Frequency', main = 'Distribution of people and the prevalence of stress in their lives', col = graphcolors, border = 'black')
barplot(table_for_graph, xlab = 'How often do you get the social and emotional support you need?', ylab = 'Frequency', main = 'Distribution of people and how often they can get emotional support when they need it', col = graphcolors, border = 'black')
table_for_graph <- table(njresponses[njresponses$SDHISOLT != 'Donâ€™t know/Not sure' & njresponses$SDHISOLT != 'Refused',]$SDHISOLT)
table_for_graph <- table_for_graph[c('Always','Usually','Sometimes','Rarely','Never')]
barplot(table_for_graph, xlab = 'How often do you feel socially isolated from others?  Is it…', ylab = 'Frequency', main = 'Distribution of people and how often they can get emotional support when they need it', col = graphcolors, border = 'black')
barplot(table_for_graph, xlab = 'How often do you feel socially isolated from others?  Is it…', ylab = 'Frequency', main = 'Distribution of people and how often they feel socially isolated from others', col = graphcolors, border = 'black')
barplot(table_for_graph, xlab = 'How often do you feel socially isolated from others?  Is it…', ylab = 'Frequency', main = 'Distribution of people and how often they feel socially isolated from others', col = graphcolors, border = 'black')
barplot(table_for_graph, xlab = 'How often do you feel socially isolated from others?  Is it…', ylab = 'Frequency', main = 'Distribution of people and how often they feel socially isolated from others', col = graphcolors, border = 'black')
barplot(table_for_graph, xlab = 'How often do you feel socially isolated from others?  Is it…', ylab = 'Frequency', main = 'Distribution of people and how often they\n feel socially isolated from others', col = graphcolors, border = 'black')
table_for_graph
chisq()
chisq.test()
library(HypothesisTesting)
chi_permutation_test
mosaic_data <- table(njresponses[njresponses$SDHISOLT != 'Donâ€™t know/Not sure' & njresponses$SDHISOLT != 'Refused', & njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$LSATISFY != 'Refused']$LSATISFY, njresponses[njresponses$SDHISOLT != 'Donâ€™t know/Not sure' & njresponses$SDHISOLT != 'Refused' & njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$LSATISFY != 'Refused',]$SDHISOLT)
mosaic_data <- table(njresponses[njresponses$SDHISOLT != 'Donâ€™t know/Not sure' & njresponses$SDHISOLT != 'Refused' & njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$LSATISFY != 'Refused',]$LSATISFY, njresponses[njresponses$SDHISOLT != 'Donâ€™t know/Not sure' & njresponses$SDHISOLT != 'Refused' & njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$LSATISFY != 'Refused',]$SDHISOLT)
mosaic_data <- mosaic_data[rev(c('Very dissatisfied', 'Dissatisfied', 'Satisfied', 'Very satisfied')), c('Always','Usually','Sometimes','Rarely','Never')]
mosaic_data
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='How often do you feel socially isolated from others?  Is it…', main = "Mosaic of level of satisfaction in life vs how often one feels socially isolated",col = graphcolors, border ='linen',las=2)
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='How often do you feel socially isolated from others?  Is it…', main = "Mosaic of level of satisfaction in life vs how often one feels socially isolated",col = graphcolors, border ='linen',las=2)
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='How often do you feel socially isolated from others?  Is it…', main = "Mosaic of level of satisfaction in life vs how often one feels socially isolated",col = graphcolors, border ='linen',las=1)
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='How often do you feel socially isolated from others?  Is it…', main = "Mosaic of level of satisfaction in life vs how often one feels socially isolated",col = graphcolors, border ='linen',las=1)
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='How often do you feel socially isolated from others?  Is it…', main = "Mosaic of level of satisfaction in life vs how often one feels socially isolated",col = graphcolors, border ='linen',las=0.5)
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='How often do you feel socially isolated from others?  Is it…', main = "Mosaic of level of satisfaction in life vs how often one feels socially isolated",col = graphcolors, border ='linen',las=1.5)
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='How often do you feel socially isolated from others?  Is it…', main = "Mosaic of level of satisfaction in life vs how often one feels socially isolated",col = graphcolors, border ='linen',las=1.4)
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='How often do you feel socially isolated from others?  Is it…', main = "Mosaic of level of satisfaction in life vs how often one feels socially isolated",col = graphcolors, border ='linen',las=1.1)
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='How often do you feel socially isolated from others?  Is it…', main = "Mosaic of level of satisfaction in life vs how often one feels socially isolated",col = graphcolors, border ='linen',las=0.1)
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='How often do you feel socially isolated from others?  Is it…', main = "Mosaic of level of satisfaction in life vs how often one feels socially isolated",col = graphcolors, border ='linen',las=-0.1)
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='How often do you feel socially isolated from others?  Is it…', main = "Mosaic of level of satisfaction in life vs how often one feels socially isolated",col = graphcolors, border ='linen',las=-0.9)
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='How often do you feel socially isolated from others?  Is it…', main = "Mosaic of level of satisfaction in life vs how often one feels socially isolated",col = graphcolors, border ='linen',las=1)
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='How often do you feel socially isolated from others?  Is it…', main = "Mosaic of level of satisfaction in life vs how often one feels socially isolated",col = graphcolors, border ='linen',las=2)
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='How often do you feel socially isolated from others?  Is it…', main = "Mosaic of level of satisfaction in life \nvs how often one feels socially isolated",col = graphcolors, border ='linen',las=2)
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='How often do you feel socially isolated from others?  Is it…', main = "Mosaic of level of satisfaction in life \nvs how often one feels socially isolated",col = graphcolors, border ='linen',las=2)
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='How often do you feel socially isolated from others?\n  Is it…', main = "Mosaic of level of satisfaction in life \nvs how often one feels socially isolated",col = graphcolors, border ='linen',las=2)
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='How often do you feel \nsocially isolated from others?  Is it…', main = "Mosaic of level of satisfaction in life \nvs how often one feels socially isolated",col = graphcolors, border ='linen',las=2)
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='How often do you feel socially\m isolated from others?  Is it…', main = "Mosaic of level of satisfaction in life \nvs how often one feels socially isolated",col = graphcolors, border ='linen',las=2)
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='How often do you feel socially\n isolated from others?  Is it…', main = "Mosaic of level of satisfaction in life \nvs how often one feels socially isolated",col = graphcolors, border ='linen',las=2)
chi_permutation_test()
chi_permutation_test(df, “attribute_1”, “attribute_2”, n)
mosaic_data
chi_permutation_test(njresponses[njresponses$SDHISOLT != 'Donâ€™t know/Not sure' & njresponses$SDHISOLT != 'Refused' & njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$LSATISFY != 'Refused',], 'LSATISFY', 'SDHISOLT', 1000)
pak::pak("r-lib/devtools")
chi_permutation_test(njresponses[njresponses$SDHISOLT != 'Donâ€™t know/Not sure' & njresponses$SDHISOLT != 'Refused' & njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$LSATISFY != 'Refused',], 'LSATISFY', 'SDHISOLT', 1000)
library(HypothesisTesting)
chi_permutation_test(njresponses[njresponses$SDHISOLT != 'Donâ€™t know/Not sure' & njresponses$SDHISOLT != 'Refused' & njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$LSATISFY != 'Refused',], 'LSATISFY', 'SDHISOLT', 1000)
pak::pak("janish-parikh/ZTest@main")
library(pak, lib.loc=library.path)
library(HypothesisTesting)
library(survey)
library(dplyr)
library(tidyr,lib.loc=library.path)
library(ggplot2)
chi_permutation_test(njresponses[njresponses$SDHISOLT != 'Donâ€™t know/Not sure' & njresponses$SDHISOLT != 'Refused' & njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$LSATISFY != 'Refused',], 'LSATISFY', 'SDHISOLT', 1000)
chisq.test(mosaic_data)
chisq.test(mosaic_data)
chisq.test(mosaic_data)
chisq.test(mosaic_data)
chisq.test(mosaic_data)
test <- chisq.test(mosaic_data)
test
test$p.value
test$expected
fisher.test(mosaic_data)
test
test$expected
mosaic_data
mosaic_plot(test$expected, xlab = 'In general, how satisfied are you with your life?', ylab ='How often do you feel socially\n isolated from others?  Is it…', main = "Mosaic of level of satisfaction in life \nvs how often one feels socially isolated(Expected)",col = graphcolors, border ='linen',las=2)
mosaicplot(test$expected, xlab = 'In general, how satisfied are you with your life?', ylab ='How often do you feel socially\n isolated from others?  Is it…', main = "Mosaic of level of satisfaction in life \nvs how often one feels socially isolated(Expected)",col = graphcolors, border ='linen',las=2)
test$p.value
par(bg = "#FFFFF0")
par(bg = "#FFFFF0")
mosaicplot(test$expected, xlab = 'In general, how satisfied are you with your life?', ylab ='How often do you feel socially\n isolated from others?  Is it…', main = "Mosaic of level of satisfaction in life \nvs how often one feels socially isolated(Expected)",col = graphcolors, border ='linen',las=2)
box_data <- njresponses[njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$LSATISFY != 'Refused' ,c("LSATISFY","POORHLTH")]
box_data$LSATISFY <- factor(box_data$LSATISFY , levels=c("Very satisfied", "Satisfied", "Dissatisfied", "Very dissatisfied"))
boxplot(data = box_data, as.numeric(POORHLTH)~LSATISFY, xlab = 'In general, how satisfied are you with your life?', ylab = 'During the past 30 days, for about how many days did poor physical\n or mental health keep you from doing your usual activities?', main = 'Boxplot of reported level of satisfaction in life vs\n number of days experiencing poor health in the past 30 days', col = graphcolors, border = "black")
par(bg = "#FFFFF0")
par(bg = "#FFFFF0")
par(mar=c(5,6,4,1)+.1)
boxplot(data = box_data, as.numeric(POORHLTH)~LSATISFY, xlab = 'In general, how satisfied are you with your life?', ylab = 'During the past 30 days, for about how many days did poor physical\n or mental health keep you from doing your usual activities?', main = 'Boxplot of reported level of satisfaction in life vs\n number of days experiencing poor health in the past 30 days', col = graphcolors, border = "black")
z_test_from_data(box_data, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
box_data$POORHLTH <- as.numeric(box_data$POORHLTH)
z_test_from_data(box_data, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
z_test_from_data(njresponses, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
box_data
z_test_from_data(box_data, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
z_test_from_data(box_data, 'LSATISFY', 'POORHLTH', 'Satisfied', 'Very Satisfied')
z_test_from_data(box_data, 'LSATISFY', 'POORHLTH', 'Satisfied', 'Very Satisfied')
Satisfied
z_test_from_data(box_data, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
permutation_test(box_data, 'LSATISFY', 'POORHLTH', 1000, 'Very Satisfied', 'Satisfied')
box_data$POORHLTH <- as.numeric(box_data$POORHLTH)
permutation_test(box_data, 'LSATISFY', 'POORHLTH', 1000, 'Very Satisfied', 'Satisfied')
permutation_test(box_data, 'LSATISFY', 'POORHLTH', 1000, 'Very Satisfied', 'Very dissatisfied')
library(HypothesisTesting)
Party <- read.csv("https://raw.githubusercontent.com/paramshah4/data101_tutorial/main/files/dataset/party2023.csv")
permutation_test(Party, 'Music', 'Attendance', 10000, 'Salsa', 'Techno')
permutation_test(box_data, 'LSATISFY', 'POORHLTH', 1000, 'Very Satisfied', 'Satisfied')
permutation_test(Party, 'Music', 'Attendance', 10000, 'Salsa', 'Techno')
box_data <- na.omit(box_data)
permutation_test(box_data, 'LSATISFY', 'POORHLTH', 1000, 'Very Satisfied', 'Satisfied')
z_test_from_data(box_data, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
box_data <- njresponses[njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$LSATISFY != 'Refused' ,c("LSATISFY","POORHLTH")]
box_data$LSATISFY <- factor(box_data$LSATISFY , levels=c("Very satisfied", "Satisfied", "Dissatisfied", "Very dissatisfied"))
box_data$POORHLTH <- as.numeric(box_data$POORHLTH)
z_test_from_data(box_data, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
min(log(box_data$POORHLTH), na.rm=TRUE)
unique(box_data$POORHLTH)
z_test_from_data(box_data, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
z_test_from_dat <- function(data, col1, col2, sub1, sub2) {
V1 <- data[, col1]
V2 <- data[, col2]
# Data clean and subset
X <- subset(data, V1 == sub2)
Y <- subset(data, V1 == sub1)
x <- X[, col2]
y <- Y[, col2]
# Z score
zeta <- (mean(x) - mean(y)) / (sqrt(sd(x)^2/length(x) + sd(y)^2/length(y))
if (is.finite(zeta)) {
print(paste(zeta, " is the z-value"))
# Calculate r and plot only if zeta is a finite number
r <- max(zeta + 0.5, 5)
plot(x = seq(from = -r, to = r, by = 0.1), y = dnorm(seq(from = -r, to = r, by = 0.1), mean = 0), type = 'l', xlab = 'mean difference', ylab = 'possibility')
abline(v = zeta, col = 'red')
# Get p
p = 1 - pnorm(zeta)
print(paste(p, " is the p-value"))
return(p)
} else {
print("Zeta is not a finite number, unable to calculate z-value and create the plot.")
return(NA)
}
}
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
permutation_test(box_data, 'LSATISFY', 'POORHLTH', 1000, 'Very Satisfied', 'Satisfied')
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
z_test_from_dat <- function(data, col1, col2, sub1, sub2) {
data <- as.data.frame(data)
V1 <- data[, col1]
V2 <- data[, col2]
# Data clean and subset
X <- subset(data, V1 == sub2)
Y <- subset(data, V1 == sub1)
x <- X[, col2]
y <- Y[, col2]
# Z score
zeta <- (mean(x) - mean(y)) / (sqrt(sd(x)^2/length(x) + sd(y)^2/length(y)))
if (is.finite(zeta)) {
print(paste(zeta, " is the z-value"))
# Calculate r and plot only if zeta is a finite number
r <- max(zeta + 0.5, 5)
plot(x = seq(from = -r, to = r, by = 0.1), y = dnorm(seq(from = -r, to = r, by = 0.1), mean = 0), type = 'l', xlab = 'mean difference', ylab = 'possibility')
abline(v = zeta, col = 'red')
# Get p
p = 1 - pnorm(zeta)
print(paste(p, " is the p-value"))
return(p)
} else {
print("Zeta is not a finite number, unable to calculate z-value and create the plot.")
return(NA)
}
}
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
z_test_from_dat <- function(data, col1, col2, sub1, sub2) {
data <- as.data.frame(data)
V1 <- data[, col1]
V2 <- data[, col2]
# Data clean and subset
X <- subset(data, V1 == sub2)
Y <- subset(data, V1 == sub1)
x <- X[, col2]
y <- Y[, col2]
# Z score
zeta <- (mean(x) - mean(y)) / (sqrt(sd(x)^2/length(x) + sd(y)^2/length(y)))
if (is.finite(zeta)) {
print(paste(zeta, " is the z-value"))
# Calculate r and plot only if zeta is a finite number
r <- max(zeta + 0.5, 5)
plot(x = seq(from = -r, to = r, by = 0.1), y = dnorm(seq(from = -r, to = r, by = 0.1), mean = 0), type = 'l', xlab = 'mean difference', ylab = 'possibility')
abline(v = zeta, col = 'red')
# Get p
p = 1 - pnorm(zeta)
print(paste(p, " is the p-value"))
return(p)
} else {
print("Zeta is not a finite number, unable to calculate z-value and create the plot.")
print(zeta)
return(NA)
}
}
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
box_data <- na.omit(box_data)
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
#return(NA)
}
z_test_from_dat <- function(data, col1, col2, sub1, sub2) {
data <- as.data.frame(data)
V1 <- data[, col1]
V2 <- data[, col2]
# Data clean and subset
X <- subset(data, V1 == sub2)
Y <- subset(data, V1 == sub1)
x <- X[, col2]
y <- Y[, col2]
# Z score
zeta <- (mean(x) - mean(y)) / (sqrt(sd(x)^2/length(x) + sd(y)^2/length(y)))
if (is.finite(zeta)) {
print(paste(zeta, " is the z-value"))
# Calculate r and plot only if zeta is a finite number
r <- max(zeta + 0.5, 5)
plot(x = seq(from = -r, to = r, by = 0.1), y = dnorm(seq(from = -r, to = r, by = 0.1), mean = 0), type = 'l', xlab = 'mean difference', ylab = 'possibility')
abline(v = zeta, col = 'red')
# Get p
p = 1 - pnorm(zeta)
print(paste(p, " is the p-value"))
return(p)
} else {
print("Zeta is not a finite number, unable to calculate z-value and create the plot.")
print(zeta)
#return(NA)
}
}
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
permutation_test(box_data, 'LSATISFY', 'POORHLTH', 1000, 'Very Satisfied', 'Satisfied')
z_test_from_dat(box_data, 'POORHLTH', 'LSATISFY', 'Very Satisfied', 'Satisfied')
box_data$POORHLTH <- as.numeric(box_data$POORHLTH)
z_test_from_dat(box_data, 'POORHLTH', 'LSATISFY', 'Very Satisfied', 'Satisfied')
z_test_from_dat(box_data, 'POORHLTH', 'LSATISFY', 'Very Satisfied', 'Satisfied')
z_test_from_dat(box_data, 'POORHLTH', 'LSATISFY', 'Very Satisfied', 'Satisfied')
return(NA)
if (is.finite(zeta)) {
print(paste(zeta, " is the z-value"))
# Calculate r and plot only if zeta is a finite number
r <- max(zeta + 0.5, 5)
plot(x = seq(from = -r, to = r, by = 0.1), y = dnorm(seq(from = -r, to = r, by = 0.1), mean = 0), type = 'l', xlab = 'mean difference', ylab = 'possibility')
abline(v = zeta, col = 'red')
# Get p
p = 1 - pnorm(zeta)
print(paste(p, " is the p-value"))
return(p)
} else {
print("Zeta is not a finite number, unable to calculate z-value and create the plot.")
print(zeta)
return(NA)
}
z_test_from_dat <- function(data, col1, col2, sub1, sub2) {
data <- as.data.frame(data)
V1 <- data[, col1]
V2 <- data[, col2]
# Data clean and subset
X <- subset(data, V1 == sub2)
Y <- subset(data, V1 == sub1)
x <- X[, col2]
y <- Y[, col2]
# Z score
zeta <- (mean(x) - mean(y)) / (sqrt(sd(x)^2/length(x) + sd(y)^2/length(y)))
if (is.finite(zeta)) {
print(paste(zeta, " is the z-value"))
# Calculate r and plot only if zeta is a finite number
r <- max(zeta + 0.5, 5)
plot(x = seq(from = -r, to = r, by = 0.1), y = dnorm(seq(from = -r, to = r, by = 0.1), mean = 0), type = 'l', xlab = 'mean difference', ylab = 'possibility')
abline(v = zeta, col = 'red')
# Get p
p = 1 - pnorm(zeta)
print(paste(p, " is the p-value"))
return(p)
} else {
print("Zeta is not a finite number, unable to calculate z-value and create the plot.")
print(zeta)
return(NA)
}
}
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
permutation_test(box_data, 'LSATISFY', 'POORHLTH', 1000, 'Very Satisfied', 'Satisfied')
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
unique(box_data$POORHLTH)
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
box_data <- njresponses[njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$LSATISFY != 'Refused' ,c("LSATISFY","POORHLTH")]
box_data$LSATISFY <- factor(box_data$LSATISFY , levels=c("Very satisfied", "Satisfied", "Dissatisfied", "Very dissatisfied"))
box_data$POORHLTH <- as.numeric(box_data$POORHLTH)
box_data_new <- na.omit(box_data)
z_test_from_dat(box_data_new, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
z_test_from_dat(box_data_new, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
unique(box_data_new$POORHLTH)
str(box_data_new)
permutation_test(njresponsesog, 'LSATISFY', 'POORHLTH', 1000, 'Very Satisfied', 'Satisfied')
permutation_test(njresponses, 'LSATISFY', 'POORHLTH', 1000, 'Very Satisfied', 'Satisfied')
z_test_from_dat(box_data_new, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
z_test_from_data(box_data_new, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
z_test_from_data(box_data_new, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
responses
permutation_test(njresponses, 'LSATISFY', 'POORHLTH', 1000, 'Very Satisfied', 'Satisfied')
permutation_test(box_data_new, 'LSATISFY', 'POORHLTH', 1000, 'Very Satisfied', 'Satisfied')
permutation_test(box_data, 'LSATISFY', 'POORHLTH', 1000, 'Very Satisfied', 'Satisfied')
responses <- read.csv('responses.csv')
permutation_test(responses, 'LSATISFY', 'POORHLTH', 1000, 'Very Satisfied', 'Satisfied')
permutation_test(responses, 'LSATISFY', 'POORHLTH', 1000, 'Very Satisfied', 'Satisfied')
z_test_from_dat(box_data_new, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
njresponses <-read.csv('njresponses.csv')
box_data <- njresponses[njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$LSATISFY != 'Refused' ,c("LSATISFY","POORHLTH")]
box_data$LSATISFY <- factor(box_data$LSATISFY , levels=c("Very satisfied", "Satisfied", "Dissatisfied", "Very dissatisfied"))
box_data <- njresponses[njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$LSATISFY != 'Refused' ,c("LSATISFY","POORHLTH")]
box_data$POORHLTH <- as.numeric(box_data$POORHLTH)
z_test_from_dat(box_data_new, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
library(HypothesisTesting)
z_test_from_dat(box_data_new, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
z_test_from_dat <- function(data, col1, col2, sub1, sub2) {
data <- as.data.frame(data)
V1 <- data[, col1]
V2 <- data[, col2]
# Data clean and subset
X <- subset(data, V1 == sub2)
Y <- subset(data, V1 == sub1)
x <- X[, col2]
y <- Y[, col2]
# Z score
zeta <- (mean(x) - mean(y)) / (sqrt(sd(x)^2/length(x) + sd(y)^2/length(y)))
if (is.finite(zeta)) {
print(paste(zeta, " is the z-value"))
# Calculate r and plot only if zeta is a finite number
r <- max(zeta + 0.5, 5)
plot(x = seq(from = -r, to = r, by = 0.1), y = dnorm(seq(from = -r, to = r, by = 0.1), mean = 0), type = 'l', xlab = 'mean difference', ylab = 'possibility')
abline(v = zeta, col = 'red')
# Get p
p = 1 - pnorm(zeta)
print(paste(p, " is the p-value"))
return(p)
} else {
print("Zeta is not a finite number, unable to calculate z-value and create the plot.")
print(zeta)
return(NA)
}
}
z_test_from_dat(box_data_new, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
permutation_test(box_data_new, 'LSATISFY', 'POORHLTH', 1000, 'Very Satisfied', 'Satisfied')
permutation_test(box_data, 'LSATISFY', 'POORHLTH', 1000, 'Very Satisfied', 'Satisfied')
box_data <- na.omit(box_data)
permutation_test(box_data, 'LSATISFY', 'POORHLTH', 1000, 'Very Satisfied', 'Satisfied')
Party <- read.csv("https://raw.githubusercontent.com/paramshah4/data101_tutorial/main/files/dataset/party2023.csv")
permutation_test(Party, 'Music', 'Attendance', 10000, 'Salsa', 'Techno')
str(Party)
str(box_data)
box_data <- njresponses[njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$LSATISFY != 'Refused' ,c("LSATISFY","POORHLTH")]
box_data$LSATISFY <- factor(box_data$LSATISFY , levels=c("Very satisfied", "Satisfied", "Dissatisfied", "Very dissatisfied"))
box_data$POORHLTH <- as.numeric(box_data$POORHLTH)
library(tidyr,lib.loc=library.path)
library.path <- .libPaths()
library(tidyr,lib.loc=library.path)
box_data %>% drop_na()
box_data %>% drop_na()
box_data %>% drop_na()
box_data %>% drop_na()
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
box_data %>% drop_na(LSATISFY, POORHLTH)
unique(box_data$POORHLTH)
box_data %>% drop_na(POORHLTH)
z_test_from_dat(na.omit(box_data), 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
permutation_test(box_data, 'LSATISFY', 'POORHLTH', 1000, 'Very Satisfied', 'Satisfied')
permutation_test <- function(df1,c1,c2,n,w1,w2){
df <- as.data.frame(df1)
D_null<-c()
V1<-df[,c1]
V2<-df[,c2]
sub.value1 <- df[df[, c1] == w1, c2]
sub.value2 <- df[df[, c1] == w2, c2]
D <-  mean(sub.value2, na.rm=TRUE) - mean(sub.value1, na.rm=TRUE)
m=length(V1)
l=length(V1[V1==w2])
for(jj in 1:n){
null <- rep(w1,length(V1))
null[sample(m,l)] <- w2
nf <- data.frame(Key=null, Value=V2)
names(nf) <- c("Key","Value")
w1_null <- nf[nf$Key == w1,2]
w2_null <- nf[nf$Key == w2,2]
D_null <- c(D_null,mean(w2_null, na.rm=TRUE) - mean(w1_null, na.rm=TRUE))
}
myhist<-hist(D_null, prob=TRUE)
multiplier <- myhist$counts / myhist$density
mydensity <- density(D_null, adjust=2)
mydensity$y <- mydensity$y * multiplier[1]
plot(myhist)
lines(mydensity, col='blue')
abline(v=D, col='red')
M<-mean(D_null>D)
return(M)
}
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
permutation_test(box_data, 'LSATISFY', 'POORHLTH', 1000, 'Very Satisfied', 'Satisfied')
unique(box_data$LSATISFY)
box_data <- njresponses[njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$LSATISFY != 'Refused' ,c("LSATISFY","POORHLTH")]
box_data$POORHLTH <- as.numeric(box_data$POORHLTH)
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
unique(box_data$LSATISFY)
box_data %>% drop_na()
unique(box_data$LSATISFY)
box_data <- box_data[complete.cases(box_data), ]
str(box_data)
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Very Satisfied', 'Satisfied')
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Satisfied', 'Dissatisfied')
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Very satisfied', 'Satisfied')
permutation_test(box_data, 'LSATISFY', 'POORHLTH', 1000, 'Very Satisfied', 'Satisfied')
permutation_test(box_data, 'LSATISFY', 'POORHLTH', 1000, 'Very satisfied', 'Satisfied')
permutation_test(box_data, 'LSATISFY', 'POORHLTH', 1000, 'Very satisfied', 'Satisfied')
t <- permutation_test(box_data, 'LSATISFY', 'POORHLTH', 1000, 'Very satisfied', 'Satisfied')
t
remove(t)
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Very satisfied', 'Satisfied')
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Very satisfied', 'Dissatisfied')
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Very satisfied', 'Very dissatisfied')
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Very satisfied', 'Dissatisfied')
permutation_test(box_data, 'LSATISFY', 'POORHLTH', 1000, 'Very satisfied', 'Very dissatisfied')
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Very satisfied', 'Very dissatisfied')
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Very satisfied', 'Satisfied')
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Very satisfied', 'Dissatisfied')
z_test_from_dat(box_data, 'LSATISFY', 'POORHLTH', 'Very satisfied', 'Very dissatisfied')
unique(njresponses)
names(njresponses)
permutation_test(box_data, 'LSATISFY', 'POORHLTH', 1000, 'Very satisfied', 'Very dissatisfied')
z_test_from_data(box_data, 'LSATISFY', 'POORHLTH', 'Very satisfied', 'Satisfied')
z_test_from_data(box_data, 'LSATISFY', 'POORHLTH', 'Very satisfied', 'Dissatisfied')
z_test_from_data(box_data, 'LSATISFY', 'POORHLTH', 'Very satisfied', 'Very dissatisfied')
box_data <- njresponses[njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$LSATISFY != 'Refused' & njresponses$SLEPTIM1 != 'Donâ€™t know/Not Sure' & njresponses$SLEPTIM1 != 'Refused',c("LSATISFY","POORHLTH")]
names(box_data)
boxplot(data = box_data, as.numeric(SLEPTIM1)~LSATISFY, xlab = 'In general, how satisfied are you with your life?', ylab = 'During the past 30 days, for about how many days did poor physical\n or mental health keep you from doing your usual activities?', main = 'Boxplot of reported level of satisfaction in life vs\n number of days experiencing poor health in the past 30 days', col = graphcolors, border = "black")
mean(njresponses$SLEPTIM1)
box_data <- njresponses[njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$LSATISFY != 'Refused' & njresponses$SLEPTIM1 != 'Donâ€™t know/Not Sure' & njresponses$SLEPTIM1 != 'Refused',c("LSATISFY","POORHLTH")]
box_data <- njresponses[njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$LSATISFY != 'Refused' & njresponses$SLEPTIM1 != 'Donâ€™t know/Not Sure' & njresponses$SLEPTIM1 != 'Refused',c("SLEPTIM1","POORHLTH")]
box_data$SLEPTIM1 <- as.numeric(box_data$SLEPTIM1)
boxplot(data = box_data, as.numeric(SLEPTIM1)~LSATISFY, xlab = 'In general, how satisfied are you with your life?', ylab = 'During the past 30 days, for about how many days did poor physical\n or mental health keep you from doing your usual activities?', main = 'Boxplot of reported level of satisfaction in life vs\n number of days experiencing poor health in the past 30 days', col = graphcolors, border = "black")
box_data <- njresponses[njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$LSATISFY != 'Refused' & njresponses$SLEPTIM1 != 'Donâ€™t know/Not Sure' & njresponses$SLEPTIM1 != 'Refused',c("LSATISFY","SLEPTIM1")]
box_data$SLEPTIM1 <- as.numeric(box_data$SLEPTIM1)
boxplot(data = box_data, as.numeric(SLEPTIM1)~LSATISFY, xlab = 'In general, how satisfied are you with your life?', ylab = 'During the past 30 days, for about how many days did poor physical\n or mental health keep you from doing your usual activities?', main = 'Boxplot of reported level of satisfaction in life vs\n number of days experiencing poor health in the past 30 days', col = graphcolors, border = "black")
graphcolors <- c('#ADD8E6','#90EE90','#FFB6C1','#E6E6FA','#FFD700','#D3D3D3')
par(bg = "#FFFFF0")
par(mar=c(5,6,4,1)+.1)
boxplot(data = box_data, as.numeric(SLEPTIM1)~LSATISFY, xlab = 'In general, how satisfied are you with your life?', ylab = 'During the past 30 days, for about how many days did poor physical\n or mental health keep you from doing your usual activities?', main = 'Boxplot of reported level of satisfaction in life vs\n number of days experiencing poor health in the past 30 days', col = graphcolors, border = "black")
box_data$LSATISFY <- factor(box_data$LSATISFY , levels=c("Very satisfied", "Satisfied", "Dissatisfied", "Very dissatisfied"))
boxplot(data = box_data, as.numeric(SLEPTIM1)~LSATISFY, xlab = 'In general, how satisfied are you with your life?', ylab = 'During the past 30 days, for about how many days did poor physical\n or mental health keep you from doing your usual activities?', main = 'Boxplot of reported level of satisfaction in life vs\n number of days experiencing poor health in the past 30 days', col = graphcolors, border = "black")
boxplot(data = box_data, as.numeric(SLEPTIM1)~LSATISFY, xlab = 'In general, how satisfied are you with your life?', ylab = 'On average, how many hours of sleep do you get in a 24-hour period?', main = 'Boxplot of reported level of satisfaction in life vs\n number of days experiencing poor health in the past 30 days', col = graphcolors, border = "black")
boxplot(data = box_data, as.numeric(SLEPTIM1)~LSATISFY, xlab = 'In general, how satisfied are you with your life?', ylab = 'On average, how many hours of sleep do you get in a 24-hour period?', main = 'Boxplot of reported level of satisfaction in life vs\n average # hours of sleep in 24 hours', col = graphcolors, border = "black")
boxplot(data = box_data, as.numeric(SLEPTIM1)~LSATISFY, xlab = 'In general, how satisfied are you with your life?', ylab = 'On average, how many hours of sleep do you get in a 24-hour period?', main = 'Boxplot of reported level of satisfaction in life\n vs average # hours of sleep in 24 hours', col = graphcolors, border = "black")
unique(njresponses$EXERANY2)
mosaic_data <- table(njresponses[njresponses$EXERANY2 != 'Donâ€™t know/Not sure' & njresponses$EXERANY2 != 'Refused' & njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$LSATISFY != 'Refused',]$LSATISFY, njresponses[njresponses$EXERANY2 != 'Donâ€™t know/Not sure' & njresponses$EXERANY2 != 'Refused' & njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$LSATISFY != 'Refused',]$EXERANY2)
mosaic_data
mosaic_data <- table(njresponses[njresponses$EXERANY2 != 'Donâ€™t know/Not Sure' & njresponses$EXERANY2 != 'Refused' & njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$LSATISFY != 'Refused',]$LSATISFY, njresponses[njresponses$EXERANY2 != 'Donâ€™t know/Not Sure' & njresponses$EXERANY2 != 'Refused' & njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$LSATISFY != 'Refused',]$EXERANY2)
mosaic_data
mosaic_data <- mosaic_data[rev(c('Very dissatisfied', 'Dissatisfied', 'Satisfied', 'Very satisfied')), c('Yes','No')]
mosaic_data
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='On average, how many hours of sleep do you get in a 24-hour period?', main = "Mosaic of level of satisfaction in life \nvs how average # of hours slept in 24 hour period",col = graphcolors, border ='linen',las=2)
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='During the past month, other than your regular job, did you participate in any physical activities or exercises such as running, calisthenics, golf, gardening, or walking for exercise?', main = "Mosaic of level of satisfaction in life \nvs how average # of hours slept in 24 hour period",col = graphcolors, border ='linen',las=2)
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='During the past month, other than your regular job, did you participate in any physical activities or exercises\n such as running, calisthenics, golf, gardening, or walking for exercise?', main = "Mosaic of level of satisfaction in life \nvs how average # of hours slept in 24 hour period",col = graphcolors, border ='linen',las=2)
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='During the past month, other than your regular job, did you participate in any\n physical activities or exercises such as running, calisthenics, golf, gardening, or walking for exercise?', main = "Mosaic of level of satisfaction in life \nvs how average # of hours slept in 24 hour period",col = graphcolors, border ='linen',las=2)
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='During the past month, other than your regular job, did you participate in any\n physical activities or exercises such as running, calisthenics, golf, gardening, or walking for exercise?', main = "Mosaic of level of satisfaction in life \nvs participating in physical activity in past 30 days",col = graphcolors, border ='linen',las=2)
par(bg = "#FFFFF0")
par(mar=c(5,6,4,1)+.1)
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='During the past month, other than your regular job, did you participate in any\n physical activities or exercises such as running, calisthenics, golf, gardening, or walking for exercise?', main = "Mosaic of level of satisfaction in life \nvs participating in physical activity in past 30 days",col = graphcolors, border ='linen',las=2)
boxplot(data = box_data, as.numeric(SLEPTIM1)~LSATISFY, xlab = 'In general, how satisfied are you with your life?', ylab = 'On average, how many hours of sleep do you get in a 24-hour period?', main = 'Boxplot of reported level of satisfaction in life\n vs average # hours of sleep in 24 hours', col = graphcolors, border = "black")
z_test_from_data(box_data, 'LSATISFY', 'SLEPTIM1', 'Very satisfied', 'Satisfied')
z_test_from_data(box_data, 'LSATISFY', 'SLEPTIM1', 'Very satisfied', 'Dissatisfied')
z_test_from_data(box_data, 'LSATISFY', 'SLEPTIM1', 'Very satisfied', 'Very dissatisfied')
test <- chisq.test(mosaic_data)
test
test$p.value
mosaicplot(test$expected, xlab = 'In general, how satisfied are you with your life?', ylab ='During the past month, other than your regular job, did you participate in any\n physical activities or exercises such as running, calisthenics, golf, gardening, or walking for exercise?', main = "Mosaic of level of satisfaction in life \nvs participating in physical activity in past 30 days",col = graphcolors, border ='linen',las=2)
mosaic_data <- table(njresponses[njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$GENHLTH != 'Donâ€™t know/Not Sure' & njresponses$LSATISFY != 'Refused' & njresponses$GENHLTH != 'Refused',]$LSATISFY,njresponses[njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$GENHLTH != 'Donâ€™t know/Not Sure' & njresponses$LSATISFY != 'Refused' & njresponses$GENHLTH != 'Refused',]$GENHLTH)
mosaic_data <- mosaic_data[rev(c('Very dissatisfied', 'Dissatisfied', 'Satisfied', 'Very satisfied')), c('Excellent', 'Very good', 'Good', 'Fair', 'Poor')]
mosaic_data <- table(njresponses[njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$GENHLTH != 'Donâ€™t know/Not Sure' & njresponses$LSATISFY != 'Refused' & njresponses$GENHLTH != 'Refused',]$LSATISFY,njresponses[njresponses$LSATISFY != 'Donâ€™t know/Not sure' & njresponses$GENHLTH != 'Donâ€™t know/Not Sure' & njresponses$LSATISFY != 'Refused' & njresponses$GENHLTH != 'Refused',]$GENHLTH)
mosaic_data <- mosaic_data[rev(c('Very dissatisfied', 'Dissatisfied', 'Satisfied', 'Very satisfied')), c('Excellent', 'Very good', 'Good', 'Fair', 'Poor')]
mosaicplot(mosaic_data, xlab = 'In general, how satisfied are you with your life?', ylab ='Would you say that in general your health is:', main = "Mosaic of level of satisfaction in life vs level of General Health",col = graphcolors, border ='linen',las=2)
mosaic_data
barplot(table_for_graph, xlab = 'Stress means a situation in which a person feels tense, restless, nervous, or anxious, or is unable to sleep at night\n because his/her mind is troubled all the time. Within the last 30 days, how often have you felt this kind of stress?', ylab = 'Frequency', main = 'Distribution of people and the prevalence of stress in their lives', col = graphcolors, border = 'black')
table_for_graph <- table(njresponses[njresponses$SDHSTRE1 != 'Donâ€™t know/Not Sure' & njresponses$SDHSTRE1 != 'Refused',]$SDHSTRE1)
table_for_graph <- table_for_graph[c('Always','Usually','Sometimes','Rarely','Never')]
barplot(table_for_graph, xlab = 'Stress means a situation in which a person feels tense, restless, nervous, or anxious, or is unable to sleep at night\n because his/her mind is troubled all the time. Within the last 30 days, how often have you felt this kind of stress?', ylab = 'Frequency', main = 'Distribution of people and the prevalence of stress in their lives', col = graphcolors, border = 'black')
table_for_graph <- table(njresponses[njresponses$SDHSTRE1 != 'Donâ€™t know/Not Sure' & njresponses$SDHSTRE1 != 'Refused',]$SDHSTRE1)
table_for_graph <- table_for_graph[c('Always','Usually','Sometimes','Rarely','Never')]
barplot(table_for_graph, xlab = 'Stress means a situation in which a person feels tense, restless, nervous, or anxious, or is unable to sleep at night\n because his/her mind is troubled all the time. Within the last 30 days, how often have you felt this kind of stress?', ylab = 'Frequency', main = 'Distribution of people and the prevalence of stress in their lives', col = graphcolors, border = 'black')
mosaic_data/sum(mosaic_data)
sum(mosaic[Excellent,])
sum(mosaic_data[Excellent,])
sum(mosaic_data[,])
sum(mosaic_data[,Excellent])
sum(mosaic_data[,'Excellent'])
mosaic_data <- mosaic_data/sum(mosaic_data)
sum(mosaic_data[,'Excellent'])
sum(mosaic_data[,'Very Good'])
sum(mosaic_data[,'Very good'])
sum(mosaic_data['Very satisfied','Very good'])
sum(mosaic_data['Very dissatisfied','Very good'])
sum(mosaic_data[,'Very good'])
sum(mosaic_data['Very satisfied',])
